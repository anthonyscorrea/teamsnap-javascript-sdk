!function(){var window,global={};!function(){"use strict";var e="undefined"!=typeof window?window:global;if("function"!=typeof e.require){var t={},r={},n=function(e,t){return{}.hasOwnProperty.call(e,t)},s=function(e,t){var r,n,s=[];r=/^\.\.?(\/|$)/.test(t)?[e,t].join("/").split("/"):t.split("/");for(var o=0,i=r.length;i>o;o++)n=r[o],".."===n?s.pop():"."!==n&&""!==n&&s.push(n);return s.join("/")},o=function(e){return e.split("/").slice(0,-1).join("/")},i=function(t){return function(r){var n=o(t),i=s(n,r);return e.require(i,t)}},a=function(e,t){var n={id:e,exports:{}};return r[e]=n,t(n.exports,i(e),n),n.exports},u=function(e,o){var i=s(e,".");if(null==o&&(o="/"),n(r,i))return r[i].exports;if(n(t,i))return a(i,t[i]);var u=s(i,"./index");if(n(r,u))return r[u].exports;if(n(t,u))return a(u,t[u]);throw new Error('Cannot find module "'+e+'" from "'+o+'"')},c=function(e,r){if("object"==typeof e)for(var s in e)n(e,s)&&(t[s]=e[s]);else t[e]=r},m=function(){var e=[];for(var r in t)n(t,r)&&e.push(r);return e};e.require=u,e.require.define=c,e.require.register=c,e.require.list=m,e.require.brunch=!0}}();var e=global.require;global=this,global.window&&(window=this),e.register("auth",function(e,t,r){var n,s,o,i,a,u,c,m,l,p,h;h=t("./teamsnap"),m=t("./request"),c=t("./promises"),m=t("./request"),l=t("./sdk"),u="application/json",i="application/vnd.collection+json",s="teamsnap.authToken",n=m.create().hook(function(e,t){return e.responseType="json",e.setRequestHeader("Accept",u),t&&e.setRequestHeader("Content-Type",u),e.withCredentials=!0}),p=m.create().hook(function(e,t){return e.responseType="json",e.setRequestHeader("Accept",i),t&&e.setRequestHeader("Content-Type",i),e.withCredentials=!0}),r.exports=function(e,t){var r,s,i,u;if(!e)throw new TSError("`teamsnap.init(clientId)` must be called in order to use TeamSnap's API. See https://auth.teamsnap.com/ to register an app.");return u=function(e,t){var r,n,s,o;n=[];for(r in t)o=t[r],o&&n.push(r+"="+encodeURIComponent(o));return s=h.authUrl+"/oauth/"+e+"?"+n.join("&"),s.replace(/%20/g,"+")},r=function(t,r,n){return n=Array.isArray(n)?n.join(" "):n,u("authorize",{response_type:t,client_id:e,redirect_uri:r,scope:n})},i=function(r){return u("token",{grant_type:"authorization_code",code:r,client_id:e,client_secret:t})},s=function(t,r){return u("token",{grant_type:"password",username:t,password:r,client_id:e})},{auth:function(e,t,r){var n;if("function"==typeof e?(r=e,e=null):"object"==typeof e&&(r=t,t=e,e=null),"function"==typeof t&&(r=t,t=null),-1!==h.apiUrl.indexOf(":3000"))return n=p.clone(),n.hook(function(e){return e.setRequestHeader("X-Teamsnap-User-ID",1)}),l(n,t,r);if(e||(e=o()),!e)throw new TSArgsError("teamsnap.auth","A token is required to auth unless in the browser it has been cached");return n=p.clone(),n.hook(function(t){return t.setRequestHeader("X-Teamsnap-Access-Token",e)}),l(n,t,r)},getServerAuthUrl:function(e,t){return r("code",e,t)},getServerTokenUrl:function(e){return i(e)},getBrowserAuthUrl:function(e,t){return r("token",e,t)},getPasswordAuthUrl:function(e,t){return s(e,t)},createDialog:function(e,t){return a(e,t)},finishServerAuth:function(e,t){return n.post(this.getServerTokenUrl(e),t)},startBrowserAuth:function(e,t,r){if("file:"===location.protocol)throw new TSError("TeamSnap.js cannot auth from the file system");return this.createDialog(this.getBrowserAuthUrl(e,t)).then(function(e){return function(t){var r;return r=t.access_token,o(r),e.auth(r)}}(this)).callback(r)},startPasswordAuth:function(e,t,r){return n.post(this.getPasswordAuthUrl(e,t),r)},isAuthed:function(){return!!o()}}},o=function(e){return global.sessionStorage?0===arguments.length?sessionStorage.getItem(s):void sessionStorage.setItem(s,e):void 0},a=function(e,t){var r,n,s,o,i,a,u,m,l,p,h;return u=860,s=720,r=c.defer(),p=window.screenLeft||window.screenX,h=window.screenTop||window.screenY,l=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,m=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=p+(l-u)/2,a=h+(m-s)/2,n=window.open(e,"oauth","menubar=no,scrollbars=no,status=no,toolbar=no,width="+u+",height="+s+",left="+i+",top="+a),o=setInterval(function(){var e,t,s;try{if(n.closed&&(clearInterval(o),r.reject({error:"access_denied",error_description:"The resource owner denied the request."})),n.location.host!==location.host)return;t=n.location.hash.replace(/^#/,"")||n.location.search.replace(/^\?/,"")}catch(i){return void(e=i)}return clearInterval(o),n.close(),s={},t.split("&").forEach(function(e){var t,r,n;return n=e.split("="),t=n[0],r=n[1],s[decodeURIComponent(t)]=decodeURIComponent(r.replace(/\+/g," "))}),s.error?r.reject(s):r.resolve(s)},50),r.promise.callback(t)}}),e.register("collections/assignments",function(e){e.loadAssignments=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadAssignments","must provide a teamId or query parameters");return this.loadItems("assignment",e,t)},e.createAssignment=function(e){return this.createItem(e,{type:"assignment",description:""})},e.saveAssignment=function(e,t){var r;if(!e)throw new TSArgsError("teamsnap.saveAssignment","`assignment` must be provided");if(!this.isItem(e,"assignment"))throw new TSArgsError("teamsnap.saveAssignment","`assignment.type` must be 'assignment'");return e.memberId?e.eventId?(null!=(r=e.description)?r.trim():void 0)?this.saveItem(e,t):this.reject("You must provide a description for the assignment.","name",t):this.reject("You must choose an event.","eventId",t):this.reject("You must choose a member.","memberId",t)},e.deleteAssignment=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteAssignment","`assignment` must be provided");return this.deleteItem(e,t)},e.assignmentSort=function(e){return function(t){return function(r,n){var s,o;return t.isItem(r,"assignment")&&t.isItem(n,"assignment")?(s=t.memberName(r.member,e).toLowerCase(),o=t.memberName(n.member,e).toLowerCase()):(s=r.type,o=n.type),s>o?1:o>s?-1:0}}(this)}}),e.register("collections/availabilities",function(e){var t,r,n,s;e.AVAILABILITIES={NONE:null,NO:0,YES:1,MAYBE:2},r={},s=e.AVAILABILITIES;for(t in s)n=s[t],r[n]=!0;e.loadAvailabilities=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadAvailabilities","must provide a teamId or query parameters");return this.loadItems("availability",e,t)},e.saveAvailability=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveAvailability","`availability` must be provided");if(!this.isItem(e,"availability"))throw new TSArgsError("teamsnap.saveAvailability","`type` must be 'availability'");return null===trackedItemStatus.statusCode||r[trackedItemStatus.statusCode]?this.saveItem(e,t):this.reject("You must select a valid status or null","statusCode",t)}}),e.register("collections/contactEmailAddresses",function(e){e.loadContactEmailAddresses=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadContactEmailAddresses","must provide a teamId or query parameters");return this.loadItems("contactEmailAddress",e,t)},e.createContactEmailAddress=function(e){return this.createItem(e,{type:"contactEmailAddress",receivesTeamEmails:!0})},e.saveContactEmailAddress=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveContactEmailAddress","`emailAddress` must be provided");if(!this.isItem(e,"contactEmailAddress"))throw new TSArgsError("teamsnap.saveContactEmailAddress","`emailAddress.type` must be 'contactEmailAddress'");return e.contactId?this.saveItem(e,t):this.reject("You must choose a contact.","contactId",t)},e.deleteContactEmailAddress=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteContactEmailAddress","`emailAddress` must be provided");return this.deleteItem(e,t)}}),e.register("collections/contactPhoneNumbers",function(e){e.loadContactPhoneNumbers=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadContactPhoneNumbers","must provide a teamId or query parameters");return this.loadItems("contactPhoneNumber",e,t)},e.createContactPhoneNumber=function(e){return this.createItem(e,{type:"contactPhoneNumber"})},e.saveContactPhoneNumber=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveContactPhoneNumber","`phoneNumber` must be provided");if(!this.isItem(e,"contactPhoneNumber"))throw new TSArgsError("teamsnap.saveContactPhoneNumber","`phoneNumber.type` must be 'contactPhoneNumber'");return e.contactId?this.saveItem(e,t):this.reject("You must choose a contact.","contactId",t)},e.deleteContactPhoneNumber=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteContactPhoneNumber","`phoneNumber` must be provided");return this.deleteItem(e,t)}}),e.register("collections/contacts",function(e){e.loadContacts=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadContacts","must provide a teamId or query parameters");return this.loadItems("contact",e,t)},e.createContact=function(e){return this.createItem(e,{type:"contact"})},e.saveContact=function(e,t){var r;if(!e)throw new TSArgsError("teamsnap.saveContact","`contact` must be provided");if(!this.isItem(e,"contact"))throw new TSArgsError("teamsnap.saveContact","`contact.type` must be 'contact'");return e.memberId?(null!=(r=e.firstName)?r.trim():void 0)?this.saveItem(e,t):this.reject("You must provide a firstName for the contact.","name",t):this.reject("You must choose a member.","memberId",t)},e.deleteContact=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteContact","`contact` must be provided");return this.deleteItem(e,t)}}),e.register("collections/customData",function(e){e.loadCustomData=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadCustomData","must provide a teamId or query parameters");return this.loadItems("customDatum",e,t)},e.saveCustomDatum=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveCustomField","`customDatum` must be provided");if(!this.isItem(e,"customDatum"))throw new TSArgsError("teamsnap.saveCustomField","`customDatum.type` must be 'customDatum'");return e.customFieldId?this.saveItem(e,t):this.reject("You must choose a custom field.","customFieldId",t)}}),e.register("collections/customFields",function(e){e.loadCustomFields=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadCustomFields","must provide a teamId or query parameters");return this.loadItems("customField",e,t)},e.createCustomField=function(e){return this.createItem(e,{type:"customField"})},e.saveCustomField=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveCustomField","`customField` must be provided");if(!this.isItem(e,"customField"))throw new TSArgsError("teamsnap.saveCustomField","`customField.type` must be 'customField'");return e.teamId?e.name?e.kind?this.saveItem(e,t):this.reject("You must choose a type.","kind",t):this.reject("You must enter a name.","name",t):this.reject("You must choose a team.","teamId",t)},e.deleteCustomField=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteCustomField","`customField` must be provided");return this.deleteItem(e,t)}}),e.register("collections/events",function(e){var t,r,n,s;e.EVENTS={NONE:"none",FUTURE:"future",ALL:"all"},t={},s=e.EVENTS;for(r in s)n=s[r],t[n]=!0;e.loadEvents=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadEvents","must provide a teamId or query parameters");return this.loadItems("event",e,t)},e.createEvent=function(e){return this.createItem(e,{type:"event",isGame:!1,tracksAvailability:!0})},e.saveEvent=function(e,t){var r,n;if(!e)throw new TSArgsError("teamsnap.saveEvent","`event` must be provided");if(!this.isItem(e,"event"))throw new TSArgsError("teamsnap.saveEvent","`event.type` must be 'event'");return e.isGame||(null!=(r=e.name)?r.trim():void 0)?e.teamId?e.locationId?e.isGame&&!e.opponentId?this.reject("You must choose an opponent.","opponentId",t):isNaN(null!=(n=e.startDate)?n.getTime():void 0)?this.reject("You must provide a valid start date.","startDate",t):this.saveItem(e,t):this.reject("You must choose a location.","locationId",t):this.reject("You must choose a team.","teamId",t):this.reject("You must provide a name.","name",t)},e.deleteEvent=function(e,r,n){var s;if(!e)throw new TSArgsError("teamsnap.deleteEvent","`event` must be provided");if("function"==typeof r&&(n=r,r=null),!r&&e.repeatingUuid&&(r=this.EVENTS.NONE),r){if(!t[r])throw new TSArgsError("teamsnap.deleteEvent","`include` must be one of "+Object.keys(t).join(", "));s={repeatingInclude:r}}return this.deleteItem(e,s,n)},e.getEventSort=function(){return function(e){return function(t,r){var n,s;return e.isItem(t,"event")&&e.isItem(r,"event")?(n=t.startDate,s=r.startDate):(n=t.type,s=r.type),n>s?1:s>n?-1:0}}(this)}}),e.register("collections/locations",function(e){e.loadLocations=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadLocations","must provide a teamId or query parameters");return this.loadItems("location",e,t)},e.createLocation=function(e){return this.createItem(e,{type:"location",name:""})},e.saveLocation=function(e,t){var r;if(!e)throw new TSArgsError("teamsnap.saveLocation","`location` must be provided");if(!this.isItem(e,"location"))throw new TSArgsError("teamsnap.saveLocation","`location.type` must be 'location'");return e.teamId?(null!=(r=e.name)?r.trim():void 0)?this.saveItem(e,t):this.reject("You must provide a name for the location.","name",t):this.reject("You must choose a team.","teamId",t)},e.deleteLocation=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteLocation","`location` must be provided");return this.deleteItem(e,t)}}),e.register("collections/memberEmailAddresses",function(e){e.loadMemberEmailAddresses=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadMemberEmailAddresses","must provide a teamId or query parameters");return this.loadItems("memberEmailAddress",e,t)},e.createMemberEmailAddress=function(e){return this.createItem(e,{type:"memberEmailAddress",receivesTeamEmails:!0})},e.saveMemberEmailAddress=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveMemberEmailAddress","`emailAddress` must be provided");if(!this.isItem(e,"memberEmailAddress"))throw new TSArgsError("teamsnap.saveMemberEmailAddress","`emailAddress.type` must be 'memberEmailAddress'");return e.memberId?this.saveItem(e,t):this.reject("You must choose a member.","memberId",t)},e.deleteMemberEmailAddress=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteMemberEmailAddress","`emailAddress` must be provided");return this.deleteItem(e,t)}}),e.register("collections/memberLinks",function(e){e.loadMemberLinks=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadMemberLinks","must provide a teamId or query parameters");return this.loadItems("memberLink",e,t)},e.createMemberLink=function(e){return this.createItem(e,{type:"memberLink"})},e.saveMemberLink=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveMemberLink","`memberLink` must be provided");if(!this.isItem(e,"memberLink"))throw new TSArgsError("teamsnap.saveMemberLink","`memberLink.type` must be 'memberLink'");return e.memberId?this.saveItem(e,t):this.reject("You must choose a member.","memberId",t)},e.deleteMemberLink=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteMemberLink","`memberLink` must be provided");return this.deleteItem(e,t)}}),e.register("collections/memberPhoneNumbers",function(e){e.loadMemberPhoneNumbers=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadMemberPhoneNumbers","must provide a teamId or query parameters");return this.loadItems("memberPhoneNumber",e,t)},e.createMemberPhoneNumber=function(e){return this.createItem(e,{type:"memberPhoneNumber"})},e.saveMemberPhoneNumber=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveMemberPhoneNumber","`phoneNumber` must be provided");if(!this.isItem(e,"memberPhoneNumber"))throw new TSArgsError("teamsnap.saveMemberPhoneNumber","`phoneNumber.type` must be 'memberPhoneNumber'");return e.memberId?this.saveItem(e,t):this.reject("You must choose a member.","memberId",t)},e.deleteMemberPhoneNumber=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteMemberPhoneNumber","`phoneNumber` must be provided");return this.deleteItem(e,t)}}),e.register("collections/memberPreferences",function(e){e.loadMembersPreferences=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadMembersPreferences","must provide a teamId or query parameters");return this.loadItems("memberPreferences",e,t)},e.loadMemberPreferences=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadMemberPreferences","must provide a teamId or query parameters");return this.loadItem("memberPreferences",e,t)},e.saveMemberPreferences=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveMemberPreferences","`memberPreferences` must be provided");if(!this.isItem(e,"memberPreferences"))throw new TSArgsError("teamsnap.saveMemberPreferences","`memberPreferences.type` must be 'memberPreferences'");return this.saveItem(e,t)},e.saveTeamPreferences=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveTeamPreferences","`teamPreferences` must be provided");if(!this.isItem(e,"teamPreferences"))throw new TSArgsError("teamsnap.saveTeamPreferences","`teamPreferences.type` must be 'teamPreferences'");return this.saveItem(e,t)}}),e.register("collections/members",function(e){e.loadMembers=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadMembers","must provide a teamId or query parameters");return this.loadItems("member",e,t)},e.createMember=function(e){return this.createItem(e,{type:"member"})},e.saveMember=function(e,t){var r;if(!e)throw new TSArgsError("teamsnap.saveMember","`member` must be provided");if(!this.isItem(e,"member"))throw new TSArgsError("teamsnap.saveMember","`type` must be 'member'");return e.teamId?(null!=(r=e.firstName)?r.trim():void 0)?this.saveItem(e,t):this.reject("You must provide a firstName for the member.","name",t):this.reject("You must choose a team.","teamId",t)},e.deleteMember=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteMember","`member` must be provided");return this.deleteItem(e,t)},e.deleteMemberPhoto=function(e){var t;if(!e)throw new TSArgsError("teamsnap.deleteMemberPhoto","`memberId` must be provided");if(this.isItem(e,"member")&&(e=e.id),!this.isId(e))throw new TSArgsError("teamsnap.deleteMemberPhoto","`memberId` must be a valid id");return t={memberId:e},this.collections.members.exec("removeOriginalPhoto",t).pop().callback(callback)},e.deleteMemberThumbnail=function(e){var t;if(!e)throw new TSArgsError("teamsnap.deleteThumbnail","`memberId` must be provided");if(this.isItem(e,"member")&&(e=e.id),!this.isId(e))throw new TSArgsError("teamsnap.deleteThumbnail","`memberId` must be a valid id");return t={memberId:e},this.collections.members.exec("removeThumbnailPhoto",t).pop().callback(callback)},e.generateThumbnail=function(e,t,r,n,s){var o;if("undefined"==typeof member||null===member||null==t||null==r||null==n||null==s)throw new TSArgsError("teamsnap.generateThumbnail","`memberId`, `x`, `y`, `width`, and `height` are all required");if(this.isItem(e,"member")&&(e=e.id),!this.isId(e))throw new TSArgsError("teamsnap.generateThumbnail","`memberId` must be a valid id");return o={memberId:member.id,cropX:t,cropY:r,cropWidth:n,cropHeight:s},this.collections.members.exec("generateThumbnailPhoto",o).pop().callback(callback)},e.memberName=function(e,t){return e?t&&e.firstName&&e.lastName?e.lastName+", "+e.firstName:[e.firstName||"",e.lastName||""].join(" ").trim():""},e.getMemberSort=function(e){return function(t){return function(r,n){var s,o;return t.isItem(r,"member")&&t.isItem(n,"member")?(s=t.memberName(r,e).toLowerCase(),o=t.memberName(n,e).toLowerCase()):(s=r.type,o=n.type),s>o?1:o>s?-1:0}}(this)},e.canEditTeam=function(e,t){return e&&t?(e.isManager||e.isOwner)&&(!t.isArchivedSeason||e.isOwner):!1},e.canEditItem=function(e,t,r){return e&&t&&this.isItem(r)?r.readOnly?!1:teamsnap.canEditTeam(e,t)?!0:t.isArchivedSeason?!1:this.isItem(r,"member")?r.id===e.id:r.memberId===e.id:!1}}),e.register("collections/opponents",function(e){e.loadOpponents=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadOpponents","must provide a teamId or query parameters");return this.loadItems("opponent",e,t)},e.createOpponent=function(e){return this.createItem(e,{type:"opponent",name:""})},e.saveOpponent=function(e,t){var r;if(!e)throw new TSArgsError("teamsnap.saveOpponent","`opponent` must be provided");if(!this.isItem(e,"opponent"))throw new TSArgsError("teamsnap.saveOpponent","`opponent.type` must be 'opponent'");return e.teamId?(null!=(r=e.name)?r.trim():void 0)?this.saveItem(e,t):this.reject("You must provide a name for the opponent.","name",t):this.reject("You must choose a team.","teamId",t)},e.deleteOpponent=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteOpponent","`opponent` must be provided");return this.deleteItem(e,t)}}),e.register("collections/plans",function(e){e.loadPlans=function(e,t){if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadPlans","must provide query parameters");return this.loadItems("plan",e,t)},e.loadPlan=function(e,t){var r;if(!this.isId(e))throw new TSArgsError("teamsnap.loadPlan","must provide a teamId");return r={teamId:e},this.loadItem("plan",r,t)}}),e.register("collections/sports",function(e){e.loadSports=function(e,t){if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadSports","must provide query parameters");return this.loadItems("sport",e,t)},e.loadSport=function(e,t){var r;if(!this.isId(e))throw new TSArgsError("teamsnap.loadSport","must provide a teamId");return r={teamId:e},this.loadItem("sport",r,t)}}),e.register("collections/teamPreferences",function(e){e.loadTeamsPreferences=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadTeamPreferences","must provide a teamId or query parameters");return this.loadItems("teamPreferences",e,t)},e.loadTeamPreferences=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadTeamPreferences","must provide a teamId or query parameters");return this.loadItem("teamPreferences",e,t)},e.saveTeamPreferences=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveTeamPreferences","`teamPreferences` must be provided");if(!this.isItem(e,"teamPreferences"))throw new TSArgsError("teamsnap.saveTeamPreferences","`teamPreferences.type` must be 'teamPreferences'");return this.saveItem(e,t)}}),e.register("collections/teamPublicSites",function(e){e.loadTeamPublicSites=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadTeamPublicSites","must provide a teamId or query parameters");return this.loadItems("teamPublicSite",e,t)},e.loadTeamPublicSite=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadTeamPublicSite","must provide a teamId or query parameters");return this.loadItem("teamPublicSite",e,t)},e.saveTeamPublicSite=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveTeamPublicSite","`teamPublicSite` must be provided");if(!this.isItem(e,"teamPublicSite"))throw new TSArgsError("teamsnap.saveTeamPublicSite","`teamPublicSite.type` must be 'teamPublicSite'");return this.saveItem(e,t)}}),e.register("collections/teams",function(e){e.loadTeams=function(e,t){return null==e&&(e={}),"function"==typeof e&&(t=e,e={}),e.userId=this.me.id,this.loadItems("team",e,t)},e.loadTeam=function(e,t){if(!this.isId(e))throw new TSArgsError("teamsnap.loadTeam","teamId must be provided");return this.loadItem("team",{teamId:e},t)},e.createTeam=function(e){return this.createItem(e,{type:"team",name:""})},e.saveTeam=function(e,t){var r;if(!e)throw new TSArgsError("teamsnap.saveTeam","`team` must be provided");if(!this.isItem(e,"team"))throw new TSArgsError("teamsnap.saveTeam","`type` must be 'team'");return(null!=(r=e.name)?r.trim():void 0)?this.saveItem(e,t):this.reject("You must provide a name for the team.","name",t)},e.deleteTeam=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteTeam","`team` must be provided");return this.deleteItem(e,t)},e.bulkLoad=function(e,t,r){var n,s;if(!this.isId(e))throw new TSArgsError("teamsnap.bulkLoad","teamId must be provided");return"function"==typeof t&&(r=t,t=null),Array.isArray(t)||(t=this.getTeamTypes()),n=function(e){return"assignment"===e&&(e="refreshment"),e[0].toUpperCase()+e.slice(1)},s={teamId:e,types:t.map(n).join(",")},this.collections.root.queryItems("bulkLoad",s,r)}}),e.register("collections/trackedItemStatuses",function(e){var t,r,n,s;e.TRACKING={NONE:null,CHECK:1,X:2},r={},s=e.TRACKING;for(t in s)n=s[t],r[n]=!0;e.loadTrackedItemStatuses=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadTrackedItemStatuses","must provide a teamId or query parameters");return this.loadItems("trackedItemStatus",e,t)},e.saveTrackedItemStatus=function(e,t){if(!e)throw new TSArgsError("teamsnap.saveTrackedItemStatus","`trackedItemStatus` must be provided");if(!this.isItem(e,"trackedItemStatus"))throw new TSArgsError("teamsnap.saveTrackedItemStatus","`trackedItemStatus.type` must be 'trackedItemStatus'");return e.trackedItemId?e.memberId?r[e.statusCode]?this.saveItem(e,t):this.reject("You must select a valid status","statusCode",t):this.reject("You must choose a member.","memberId",t):this.reject("You must choose a tracked item.","trackedItemId",t)}}),e.register("collections/trackedItems",function(e){e.loadTrackedItems=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadTrackedItems","must provide a teamId or query parameters");return this.loadItems("trackedItem",e,t)},e.createTrackedItem=function(e){return this.createItem(e,{type:"trackedItem",name:""})},e.saveTrackedItem=function(e,t){var r;if(!e)throw new TSArgsError("teamsnap.saveTrackedItem","`trackedItem` must be provided");if(!this.isItem(e,"trackedItem"))throw new TSArgsError("teamsnap.saveTrackedItem","`trackedItem.type` must be 'trackedItem'");return e.teamId?(null!=(r=e.name)?r.trim():void 0)?this.saveItem(e,t):this.reject("You must provide a name for the trackedItem.","name",t):this.reject("You must choose a team.","teamId",t)},e.deleteTrackedItem=function(e,t){if(!e)throw new TSArgsError("teamsnap.deleteTrackedItem","`trackedItem` must be provided");return this.deleteItem(e,t)},e.trackedItemSort=function(){return function(e){return function(t,r){var n,s;return e.isItem(t,"trackedItem")&&e.isItem(r,"trackedItem")?(n=t.createdAt,s=r.createdAt):(n=t.type,s=r.type),s>n?1:n>s?-1:0}}(this)}}),e.register("collections/users",function(e){e.loadUsers=function(e,t){if(this.isId(e))e={teamId:e};else if(!e||"object"!=typeof e)throw new TSArgsError("teamsnap.loadUsers","must provide a teamId or query parameters");return this.loadItems("user",e,t)},e.saveUser=function(e,t){var r;if(!e)throw new TSArgsError("teamsnap.saveUser","`user` must be provided");if(!this.isItem(e,"user"))throw new TSArgsError("teamsnap.saveUser","`user.type` must be 'user'");return(null!=(r=e.email)?r.trim():void 0)?this.saveItem(e,t):this.reject("You must provide an email for the user.","email",t)}}),e.register("errors",function(e,t){var r,n,s,o,i,a={}.hasOwnProperty,u=function(e,t){function r(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};i=t("../teamsnap"),n=function(e){function t(e){t.__super__.constructor.call(this),this.name="TeamSnapError",this.message=e}return u(t,e),t}(Error),r=function(e){function t(e,r){t.__super__.constructor.call(this),this.name="TeamSnapArgumentError",this.message="Failed to execute `"+e+"`: "+r+"."}return u(t,e),t}(TypeError),o=function(e){function t(e,r){t.__super__.constructor.call(this),this.name="TeamSnapValidationError",this.message=e,this.field=r}return u(t,e),t}(RangeError),s=function(e){function t(e){t.__super__.constructor.call(this),this.name="TeamSnapServerError",this.message=e||"An unknown error occurred on TeamSnap's server."}return u(t,e),t.create=function(e,r){return new t(e,r)},t}(Error),global.TSError=n,global.TSArgsError=r,global.TSValidationError=o,global.TSServerError=s}),e.register("linkItems",function(e,t){var r;r=t("./linking"),e.linkItems=r.linkItems,e.unlinkItems=r.unlinkItems}),e.register("linking",function(e,t){var r,n,s,o,i,a,u,c,m,l,p;o=t("./types"),e.linkItems=function(e,t){var s;return null==t&&(t={}),e?Array.isArray(e)?(e.forEach(function(e){return e.href?t[e.href]=e:void 0}),s=e.map(function(e){return n(e,t)}),r(s)):(e.href&&(t[e.href]=e),n(e,t)):function(){}},e.unlinkItems=function(e,t){var n;return null==t&&(t={}),e?Array.isArray(e)?(n=e.map(function(e){return m(e,t)}),r(n)):m(e):function(){}},n=function(e,t){var n;if(e.href){if(!t)throw new TSArgsError("linkItem","lookup must be provided");return n=[],n.push(i(t,e.href,e)),e.links.each(function(r,a){var u;if(o.isPluralType(r))return n.push(i(e,r,[]));if(u=t[a])return n.push(i(e,r,u)),n.push(s(e,u))}),r(n)}},s=function(e,t){var n,s;return s=[],n=o.getPluralType(e.type),n&&t.links.has(n)?s.push(a(t,n,e)):t.links.each(function(r,n){return n===e.href?s.push(i(t,r,e)):void 0}),r(s)},m=function(e,t){var n;if(e.href)return n=[],(null!=t?t[e.href]:void 0)===e&&n.push(u(t,e.href)),e.links.each(function(t){var r;return o.isPluralType(t)?e[t]?(n.push(p(e[t],e.href)),n.push(u(e,t))):void 0:(r=e[t],n.push(u(e,t)),n.push(l(e,r)))}),r(n)},l=function(e,t){var n,s;return s=[],n=o.getPluralType(e.type),n&&t.links.has(n)&&t[n]===e?s.push(c(t,n,e)):t.links.each(function(r,n){return n===e.href&&t[r]===e?s.push(u(t,r)):void 0}),r(s)},p=function(e,t){var n;return n=[],e.forEach(function(e){return e.links.each(function(r,s){return s===t?n.push(u(e,r)):void 0})}),r(n)},r=function(e){return function(){return e.forEach(function(e){return e()})}},i=function(e,t,r){var n,s;return n=e.hasOwnProperty(t),s=e[t],e[t]=r,function(){return n?e[t]=s:delete e[t]}},a=function(e,t,r){return e[t]||(e[t]=[]),e[t].push(r),function(){var n;return e[t]&&(n=e[t].indexOf(r),-1!==n)?e[t].splice(n,1):void 0}},u=function(e,t){var r;return r=e[t],delete e[t],function(){return e[t]=r}},c=function(e,t,r){var n;return n=e[t].indexOf(r),-1===n?function(){}:(e[t].splice(n,1),function(){var s;return e[t]||(e[t]=[]),s=e[t].length,e[t].splice(n,0,e),e[t].length===s?e[t].push(r):void 0})},e.linkItem=n,e.linkItemWith=s,e.unlinkItem=m,e.unlinkItemFrom=l,e.unlinkItemsFrom=p,e.groupUndos=r,e.undoableAdd=i,e.undoableAddTo=a,e.undoableRemove=u,e.undoableRemoveFrom=c}),e.register("loadCollections",function(e,t,r){var n,s,o,i;o=t("./promises"),i=t("./types"),n=t("./model").Collection,s=null,r.exports=function(e,t){var r,a,u;if(!s||"reject"===s.getStatus())if(t){r={};for(a in t)u=t[a],r[a]=new n(u);s=o.resolve(r)}else s=e.get(teamsnap.apiUrl).then(function(t){var s,a;return r={},r.root=a=n.fromData(t.response),s=[],i.getTypes().forEach(function(t){var o;return o=i.getPluralType(t),a.links.has(o)?s.push(e.get(a.links.href(o)).then(function(e){return r[o]=n.fromData(e.response)})):void 0}),o.when.apply(o,s).then(function(){return r})});return s}}),e.register("model",function(e){var t,r,n,s,o,i,a,u={}.hasOwnProperty,c=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e
};t=function(){function e(e){null==e&&(e={}),this.href=e.href,this.links=new n(e.links),this.queries=new n(e.queries),this.commands=new n(e.commands),this.template=e.template||[],e.items&&(this.items=e.items)}return e.fromData=function(t){return(new e).deserialize(t)},e.prototype.deserialize=function(e){var t,r;return e.collection&&(e=e.collection),e?(this.href=e.href,this.links.deserialize(e.links),this.queries.deserialize(e.queries),this.commands.deserialize(e.commands),this.template=(null!=(t=e.template)?t.data:void 0)||[],(null!=(r=e.items)?r.length:void 0)&&(this.items=e.items),this):void 0},e}(),s=function(e){function n(e,t){this._request=e,this.href=t.href,this.links=t.links,this.queries=t.queries,this.commands=t.commands,this.template=t.template,t.items&&(this.items=r.fromArray(this._request,t.items))}return c(n,e),n.fromData=function(e,r){return new n(e,(new t).deserialize(r))},n.prototype.save=function(e,t){var n,s;return e instanceof r||(e=r.create(this._request,e)),s=e.href?"put":"post",n=e.serialize(this.template),this._request(s,e.href||this.href,n).then(function(t){var n,s,o;if(n=null!=(s=t.response)&&null!=(o=s.collection)?o.items:void 0){if(n.length>1)return r.fromArray(n);if(n.length)return e.deserialize(t.response)}}).callback(t)},n.prototype.loadItems=function(e,t){return this.links.loadItems(this._request,e,t)},n.prototype.loadItem=function(e,t){return this.links.loadItem(this._request,e,t)},n.prototype.queryItems=function(e,t,r){return this.queries.loadItems(this._request,e,t,r)},n.prototype.queryItem=function(e,t,r){return this.queries.loadItem(this._request,e,t,r)},n.prototype.exec=function(e,t,r){return this.commands.exec(this._request,e,t,r)},n}(t),r=function(){function e(e,t){this._request=e,"string"==typeof t?this.href=t:t&&"object"==typeof t&&i(t,this),this.links=new n(null!=t?t.links:void 0)}return e.create=function(t,r){return new e(t,r)},e.fromArray=function(t,r){return Array.isArray(r)?r.map(function(r){return e.fromData(t,r)}):r},e.fromData=function(e,t){return t.collection||t.data?this.create(e).deserialize(t):this.create(e,t)},e.prototype.deserialize=function(e){var t,r,n,s,i,a;if((null!=e?e.collection:void 0)&&(e=null!=(i=e.collection.items)?i[0]:void 0),e){for(this.href=e.href,this.links.deserialize(e.links),a=e.data,n=0,s=a.length;s>n;n++)t=a[n],r=t.value,"type"===t.name&&(r=o(r),r=r[0].toLowerCase()+r.slice(1)),"Date"===t.type&&(r=new Date(t.value)),this[o(t.name)]=r;return this}},e.prototype.serialize=function(e){var t;if(!(null!=e?e.length:void 0))throw new TSError("You must provide the collection's template");return t=[],e.forEach(function(e){return function(r){var n;return n=e[o(r.name)],"type"===r.name&&(n=a(n)),n?t.push({name:r.name,value:n}):void 0}}(this)),{template:{data:t}}},e.prototype.loadItems=function(e,t){return this.links.loadItems(this._request,e,t)},e.prototype.loadItem=function(e,t){return this.links.loadItem(this._request,e,t)},e.prototype["delete"]=function(e,t){var r,n,s,o;if("function"==typeof e&&(t=e,e=null),e){n=[];for(s in e)u.call(e,s)&&(o=e[s],n.push({name:a(s),value:o}));r={template:{data:n}}}return this._request["delete"](this.href,r).callback(t)},e}(),n=function(){function e(e){e&&i(e,this)}return e.prototype.deserialize=function(e){var t,r,n,s,i,a,u,c,m;if(Array.isArray(e)){for(m=[],s=0,a=e.length;a>s;s++){if(t=e[s],n={},Array.isArray(t.data))for(c=t.data,i=0,u=c.length;u>i;i++)r=c[i],n[o(r.name)]=r.value;"refreshments"===t.rel&&(t.rel="assignments"),m.push(this[o(t.rel)]={href:t.href,params:n})}return m}},e.prototype.has=function(e){return this.hasOwnProperty(e)},e.prototype.href=function(e){var t;return null!=(t=this[e])?t.href:void 0},e.prototype.each=function(e){var t,r,n;n=[];for(r in this)u.call(this,r)&&(t=this[r],n.push(e(r,t.href,t.params)));return n},e.prototype.loadItems=function(e,t,r,n){return"function"==typeof r&&(n=r,r=void 0),this._request(e,"get",t,r,"items").callback(n)},e.prototype.loadItem=function(e,t,r,n){return"function"==typeof r&&(n=r,r=void 0),this._request(e,"get",t,r,"item").callback(n)},e.prototype.exec=function(e,t,r,n){return"function"==typeof r&&(n=r,r=void 0),this._request(e,"post",t,r,"items").callback(n)},e.prototype._request=function(e,t,n,s,o){var i,c,m,l;if(!(c=this[n]))throw new TSError("Unable to find rel '"+n+"'");if(s){i={};for(m in s)u.call(s,m)&&(l=s[m],c.params.hasOwnProperty(m)&&(i[a(m)]=l))}return e(t,c.href,i).then(function(t){var n,s;return n=r.fromArray(e,null!=(s=t.response.collection)?s.items:void 0)||[],"item"===o?n.pop():n})},e}(),i=function(e,t){return Object.keys(e).forEach(function(r){return"function"!=typeof value&&"_"!==r.charAt(0)?t[r]=e[r]:void 0}),t},o=function(e){return e.replace(/[-_]+(\w)/g,function(e,t){return t.toUpperCase()})},a=function(e){return e.replace(/[A-Z]/g,function(e){return"_"+e.toLowerCase()})},e.Collection=t,e.ScopedCollection=s,e.Item=r,e.MetaList=n}),e.register("persistance",function(e,t){var r,n,s,o,i,a,u,c,m,l,p,h,d,f,v,I;m=t("./promises"),i=t("./linking"),d=t("./types"),I=t("./model"),s=I.ScopedCollection,r=I.Item,n=I.MetaList,a=null,e.enablePersistance=function(){var e;if(!a)return e=this,this.persistanceEnabled=!0,u(),c(this)},e.disablePersistance=function(){return a?(this.persistanceEnabled=!1,a=null,i.unlinkItems(Object.keys(a).map(function(e){return a[e]}),a),l(),p(this)):void 0},u=function(){return f(s.prototype,"save",function(e){return function(t,r){return e.call(this,t).then(saveState).callback(r)}}),f(r.prototype,"delete",function(e){return function(t,r){var n,s;return n=this,s=i.unlinkItem(n,a),e.call(this,t).fail(s).callback(r)}}),f(r,"create",function(e){return function(t,r){var n;return n=e.call(this,t,r),n.href&&i.linkItem(n,a),n}}),f(r.prototype,"deserialize",function(e){return function(t){var r,n;return(null!=t?t.collection:void 0)&&(t=null!=(n=t.collection.items)?n[0]:void 0),r=a[t.href]||this,e.call(r,t),i.linkItem(r,a),r.saveState()}}),r.prototype.saveState=function(){return this._state=o(this,{}),this._state._undos=[function(e){return function(){return o(e._state,e)}}(this)],this._state.undo=i.groupUndos(this._state._undos),this},r.prototype.rollback=function(){var e;return null!=(e=this._state)&&e.undo(),this._state._undos.length=1,this},r.prototype.link=function(e,t){var r;return this._state||this.saveState(),r=this._state._undos,r.push(i.undoableAdd(this,e,t)),t.id&&r.push(i.undoableAdd(this,e+"Id",t.id)),r.push(i.linkItemWith(this,t)),this}},l=function(){return h(s.prototype,"save"),h(r.prototype,"delete"),h(r,"create"),delete r.prototype.saveState,delete r.prototype.rollback,delete r.prototype.link},c=function(e){return v(e,"saveMember",function(t){return m.when(e.loadAvailabilities({memberId:t.id}),e.loadTrackedItemStatuses({memberId:t.id}),e.loadCustomData({memberId:t.id}))}),f(e,"deleteMember",function(e){return function(t,r){var n;return n=[],n.push.apply(n,t.assignments),n.push.apply(n,t.availabilities),t.contacts.forEach(function(e){return n.push.apply(n,e.contactEmailAddresses),n.push.apply(n,e.contactPhoneNumbers),n.push(e)}),n.push.apply(n,t.trackedItemStatuses),e.call(this,t,r).then(function(e){return i.unlinkItems(n,a),e}).callback(r)}}),f(e,"deleteContact",function(e){return function(t,r){var n;return n=[],n.push.apply(n,t.contactEmailAddresses),n.push.apply(n,t.contactPhoneNumbers),e.call(this,t,r).then(function(e){return i.unlinkItems(n,a),e}).callback(r)}}),v(e,"saveEvent",function(t){return e.loadAvailabilities({eventId:t.id})}),f(e,"deleteEvent",function(t){return function(r,n,s){var o,u,c,m,l,p;return o=[],"string"==typeof n&&n!==e.EVENTS.NONE?(m=r.repeatingUuid,u=r.startDate,null!=(l=r.team)&&null!=(p=l.events)&&p.forEach(function(e){return e.repeatingUuid===m?o.push(e):void 0}),n===e.EVENTS.FUTURE&&(o=o.filter(function(e){return e.startDate>=u}))):o.push(r),c=o.slice(),o.forEach(function(e){return c.push.apply(c,e.assignments),c.push.apply(c,e.availabilities)}),t.call(this,r,n,s).then(function(e){return i.unlinkItems(c,a),e}).callback(s)}}),v(e,"saveTrackedItem",function(t){return e.loadTrackedItemStatuses({trackedItemId:t.id})}),f(e,"deleteTrackedItem",function(e){return function(t,r){var n;return n=t.trackedItemStatuses.slice(),e.call(this,t).then(function(e){return i.unlinkItems(n,a),e}).callback(r)}}),f(e,"deleteTeam",function(e){return function(t,r){var n;return n=[],t.links.each(function(e){var r;return r=t[name],d.getType(e)&&"sport"!==e&&"plan"!==e?Array.isArray(r)?n.push.apply(n,r):n.push(r):void 0}),e.call(this,t).then(function(e){return i.unlinkItems(n,a),e}).callback(r)}})},p=function(e){return h(e,"saveMember"),h(e,"deleteMember"),h(e,"deleteContact"),h(e,"saveEvent"),h(e,"deleteEvent"),h(e,"saveTrackedItem"),h(e,"deleteTrackedItem"),h(e,"deleteTeam")},f=function(e,t,r){var n;return n=e[t],e[t]=r(n),e[t].oldMethod=n,e},h=function(e,t){var r;return r=e[t].oldMethod,e[t]=r},v=function(e,t,r){return f(e,t,function(e){return function(t,n){var s;return t.id?e.call(this,t,n):(s=null,e.call(t).then(function(e){return s=e}).then(r).then(function(){return s}).callback(n))}})},o=function(e,t){return Object.keys(e).forEach(function(r){return"function"!=typeof value&&"_"!==r.charAt(0)?t[r]=e[r]:void 0}),t}}),e.register("promises",function(e){var t,r,n,s,o=function(e,t){return function(){return e.apply(t,arguments)}},i=[].slice,a={}.hasOwnProperty;s="undefined"!=typeof e?e:this,r=function(){function e(){this.call=o(this.call,this)}return e.prototype.then=function(){throw new TypeError("The Promise base class is abstract, this function is overwritten by the promise's deferred object")},e.prototype.callback=function(e){return e&&"function"==typeof e&&this.then(function(){var t;return t=1<=arguments.length?i.call(arguments,0):[],e.apply(null,[null].concat(i.call(t)))},function(t){return e(t)}),this},e.prototype.resolved=function(e){return this.then(e)},e.prototype.done=function(e){return this.then(e)},e.prototype.rejected=function(e){return this.then(null,e)},e.prototype.fail=function(e){return this.then(null,e)},e.prototype.always=function(e){var t,r;return r=function(t){return e(null,t)},t=function(t){return e(t)},this.then(r,t)},e.prototype.progress=function(e){return this.then(null,null,e)},e.prototype.canceled=function(e){return this.then(null,null,null,e)},e.prototype.apply=function(e,t){return this.then(function(r){return(r instanceof Array)(e.apply(t||this,r))?void 0:e.call(t||this,r)})},e.prototype.cancel=function(){throw new TypeError("The Promise base class is abstract, this function is overwritten by the promise's deferred object")},e.prototype.get=function(e){return this.then(function(t){return null!=t?t[e]:void 0})},e.prototype.set=function(e,t){return this.then(function(r){return null!=r&&(r[e]=t),r})},e.prototype.put=function(e,t){return this.then(function(r){return null!=r?r[e]=t:void 0})},e.prototype.run=function(){var e,t;return e=arguments[0],t=2<=arguments.length?i.call(arguments,1):[],this.then(function(r){return null!=r&&r[e].apply(r,t),r})},e.prototype.call=function(){var e,t;return e=arguments[0],t=2<=arguments.length?i.call(arguments,1):[],this.then(function(r){return r[e].apply(r,t)})},e}(),["pop","shift","splice","filter","every","map","some"].forEach(function(e){return r.prototype[e]=function(){var t;return t=1<=arguments.length?i.call(arguments,0):[],this.then(function(r){return null!=r&&"function"==typeof r[e]?r[e].apply(r,t):void 0})}}),["push","reverse","sort","unshift","forEach"].forEach(function(e){return r.prototype[e]=function(){var t;return t=1<=arguments.length?i.call(arguments,0):[],this.then(function(r){return r instanceof Array&&r[e].apply(r,t),r})}}),r.extend=function(e){var t,r,n;if(t=function(){},t.extend=this.extend,t.prototype=new this,e)for(r in e)a.call(e,r)&&(n=e[r],t.prototype[r]=n);return t},s.when=function(){var e,t,r,n,o,a,u,c,m,l,p,h;for(u=1<=arguments.length?i.call(arguments,0):[],n=s.defer(),t=u.length,c=!1,l=function(){},m=function(e){return c=!0,e},r=function(e){return function(){var r;return r=1<=arguments.length?i.call(arguments,0):[],u[e]=r.length>1?r:r[0],0===--t?c?n.reject.apply(n,u):n.resolve.apply(n,u):void 0}},o=p=0,h=u.length;h>p;o=++p)a=u[o],a&&"function"==typeof a.then?(e=r(o),a.then(l,m),a.then(e,e)):--t;return 0===t&&n.resolve.apply(n,u),n.promise},n=function(){var e;return e=1<=arguments.length?i.call(arguments,0):[],e.isArgs=!0,e},t=function(){function e(e){null==e&&(e=new s.Promise),this.progress=o(this.progress,this),this.cancel=o(this.cancel,this),this.reject=o(this.reject,this),this.resolve=o(this.resolve,this),this.finished=o(this.finished,this),this.then=o(this.then,this),this.promise=e,this.status="pending",this.progressHandlers=[],this.handlers=[],e.then=this.then,e.cancel=this.cancel,e.getStatus=function(e){return function(){return e.status}}(this)}return e.prototype.then=function(e,t,r,n){var o,i,a,u,c;return r&&this.progressHandlers.push(r),u=s.defer(),u.promise.prev=this.promise,this._addHandler(e,t,n).nextDeferred=u,this.finished()&&(i=this.handlers.pop(),a=i[this.status],o=i.nextDeferred,a?(c=a.apply(null,this.results),c&&"function"==typeof c.then?c.then(o.resolve,o.reject):o[this.status](c)):o[this.status].apply(o,this.results)),u.promise},e.prototype.finished=function(){return"pending"!==this.status},e.prototype.resolve=function(){var e,t,r,n,s,o;if(s=1<=arguments.length?i.call(arguments,0):[],"pending"===this.status)for((null!=(o=s[0])?o.isArgs:void 0)&&(s=s[0]),clearTimeout(this._timeout),this.status="resolve",this.results=s;t=this.handlers.shift();)r=t[this.status],e=t.nextDeferred,r?(n=r.apply(null,this.results),n&&"function"==typeof n.then?n.then(e.resolve,e.reject):e[this.status](n)):e[this.status].apply(e,this.results)},e.prototype.reject=function(){var e,t,r,n,s,o;if(s=1<=arguments.length?i.call(arguments,0):[],"pending"===this.status)for((null!=(o=s[0])?o.isArgs:void 0)&&(s=s[0]),clearTimeout(this._timeout),this.status="reject",this.results=s;t=this.handlers.shift();)r=t[this.status],e=t.nextDeferred,r?(n=r.apply(null,this.results),n&&"function"==typeof n.then?n.then(e.resolve,e.reject):e[this.status](n)):e[this.status].apply(e,this.results)},e.prototype.cancel=function(){var e,t,r,n,s,o,a;if(s=1<=arguments.length?i.call(arguments,0):[],"pending"===this.status){for((null!=(o=s[0])?o.isArgs:void 0)&&(s=s[0]),clearTimeout(this._timeout),this.status="cancel",this.results=s;t=this.handlers.shift();)r=t[this.status],e=t.nextDeferred,r?(n=r.apply(null,this.results),n&&"function"==typeof n.then?n.then(e.resolve,e.reject):e[this.status](n)):e[this.status].apply(e,this.results);null!=(a=this.promise.prev)&&a.cancel()}},e.prototype.progress=function(){var e,t,r,n,s,o;for(e=1<=arguments.length?i.call(arguments,0):[],s=this.progressHandlers,o=[],r=0,n=s.length;n>r;r++)t=s[r],o.push(t.apply(null,e));return o},e.prototype.timeout=function(e,t){return clearTimeout(this._timeout),this._timeout=setTimeout(function(e){return function(){return e.reject(null!=t?t:new Error("Operation timed out"))}}(this),e)},e.prototype.reset=function(){return this.status="pending",this.progressHandlers=[],this.handlers=[]},e.prototype._addHandler=function(e,t,r){var n;return n={resolve:e,reject:t,cancel:r},this.handlers.push(n),n},e}(),s.Deferred=t,s.Promise=r,s.args=n,s.defer=function(e){return new s.Deferred(e)},s.wrap=function(e,t){return function(){var r,n,o,a;return r=1<=arguments.length?i.call(arguments,0):[],a=t?new t:void 0,o=s.defer(a),"function"==typeof r[r.length-1]&&(n=r.pop()),r.push(function(e,t){var r;return r=Array.prototype.slice.call(arguments,2),n&&n.apply(null,[e,t].concat(i.call(r))),e?o.reject(e):o.resolve.apply(o,[t].concat(i.call(r)))}),e.apply(this,r),o.promise}},s.resolve=function(){var e,t;return e=1<=arguments.length?i.call(arguments,0):[],t=s.defer(),t.resolve.apply(t,e),t.promise},s.reject=function(){var e,t;return e=1<=arguments.length?i.call(arguments,0):[],t=s.defer(),t.reject.apply(t,e),t.promise}}),e.register("request",function(e,t,r){var n,s,o,i,a,u={}.hasOwnProperty,c=function(e,t){function r(){this.constructor=e}for(var n in t)u.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};"undefined"==typeof XMLHttpRequest&&(global.XMLHttpRequest=t("xmlhttprequest").XMLHttpRequest),o=t("./promises"),i=function(e,t,r,s,i){var u,c,m,l,p,h,d,f;if(r&&"GET"===e.toUpperCase()){l=[];for(m in r)p=r[m],l.push(encodeURIComponent(m)+"="+encodeURIComponent(p));l.length&&(t+=-1===t.indexOf("?")?"?":"&",t+=l.join("&"))}else"object"==typeof r&&(r=JSON.stringify(r));if(h=new XMLHttpRequest,h.open(e.toUpperCase(),t),s)for(d=0,f=s.length;f>d;d++)(c=s[d])(h,r);return u=o.defer(),h.onreadystatechange=function(){var e,t,r,s;switch(h.readyState){case 3:return u.progress(h);case 4:if(!h.hasOwnProperty("response"))try{h.response=JSON.parse(h.responseText)}catch(i){e=i,h.response=null}return h.status>=400&&(t=(null!=(r=h.response)&&null!=(s=r.error)?s.message:void 0)||""),0===h.status?a?o.defer().promise:u.reject(new n(n.CONNECTION_ERROR,"Could not connect to the server"),h,t):h.status>=500?(global.console&&console.error("TeamSnap API error: "+t),u.reject(new n(n.SERVER_ERROR,"Error with the server"),h,t)):h.status>400?u.reject(new n(n.CLIENT_ERROR,"There was an error with the request"),h,t):400===h.status?u.reject(new n(n.VALIDATION_ERROR,"The data was invalid"),h,t):u.resolve(h)}},h.send(r||null),u.promise.callback(i)},s=function(e){var t;return null==e&&(e=[]),t=function(t,r,n,s){return"function"==typeof n&&(s=n,n=null),i(t,r,n,e,s)},t.get=function(e,r,n){return t("get",e,r,n)},t.post=function(e,r,n){return t("post",e,r,n)},t.put=function(e,r,n){return t("put",e,r,n)},t["delete"]=function(e,r,n){return t("delete",e,r,n)},t.create=function(){return s()},t.clone=function(){return s(e.slice())},t.reset=function(){return e=[],this},t.hook=function(t){return e.push(t),this},t.removeHook=function(t){var r;return r=e.indexOf(t),-1!==r&&e.splice(r,1),this},t},r.exports=s(),n=function(e){function t(e,r){this.code=e,this.message=r,t.__super__.constructor.call(this),this.name="RequestError"}return c(t,e),t.CONNECTION_ERROR=1,t.SERVER_ERROR=2,t.CLIENT_ERROR=3,t.VALIDATION_ERROR=4,t}(Error),"undefined"!=typeof window&&(a=!1,window.addEventListener("beforeunload",function(){a=!0}))}),e.register("sdk",function(e,t,r){var n,s,o,i,a,u,c,m,l,p={}.hasOwnProperty;c=t("./teamsnap"),u=t("./promises"),i=t("./loadCollections"),l=t("./model"),n=l.Item,s=l.ScopedCollection,m=/^https?:\/\//,r.exports=function(e,t,r){return"function"==typeof t&&(r=t,t=null),i(e,t).then(function(t){var n;return n=o(e,t),n.plans=t.plans.items,n.sports=t.sports.items,n.collections.root.loadItem("me").then(function(e){return n.me=e,n}).callback(r)})},o=function(e,r){var o,i,c,l,p;l={};for(c in r)i=r[c],l[c]=new s(e,i);return p={request:e,collections:l,loadItems:function(e,t,r){if(!this.hasType(e))throw new TSArgsError("teamsnap.load*","must provide a valid `type`");return i=this.getCollectionForItem(e),i.queryItems("search",t,r)},loadItem:function(e,t,r){if(!this.hasType(e))throw new TSArgsError("teamsnap.load*","must provide a valid `type`");return i=this.getCollectionForItem(e),i.queryItem("search",t,r)},createItem:function(e,t){if(e||(e=t,t=null),t&&(e=a(e,t)),!this.isItem(e))throw new TSArgsError("teamsnap.create*","must include a valid `type`");return n.create(this.request,e)},saveItem:function(e,t){if(!this.isItem(e))throw new TSArgsError("teamsnap.save*","must include a valid `type`");return i=this.getCollectionForItem(e),i.save(e,t)},deleteItem:function(e,t,r){if("string"==typeof e&&m.test(e)&&(e={href:e}),"string"!=typeof(null!=e?e.href:void 0)||!m.test(e.href))throw new TSArgsError("teamsnap.delete*","item must have a valid href to delete");return e instanceof n||(e=n.create(this.request,e)),e["delete"](t,r)},getCollectionForItem:function(e){var t,r;return r="string"==typeof e?e:e.type,t=this.getPluralType(r),this.collections[t]},isId:function(e){return"string"==typeof e||"number"==typeof e},isItem:function(e,t){return this.hasType(null!=e?e.type:void 0)&&(!t||e.type===t)},reject:function(e,t,r){return u.reject(new TSValidationError(e,t)).callback(r)}},o=function(e){var t,r,n;n=[];for(t in e)r=e[t],n.push(p[t]=r);return n},o(t("./types")),o(t("./linkItems")),o(t("./persistance")),o(t("./collections/teams")),o(t("./collections/assignments")),o(t("./collections/availabilities")),o(t("./collections/contactEmailAddresses")),o(t("./collections/contactPhoneNumbers")),o(t("./collections/contacts")),o(t("./collections/customData")),o(t("./collections/customFields")),o(t("./collections/events")),o(t("./collections/locations")),o(t("./collections/memberEmailAddresses")),o(t("./collections/memberLinks")),o(t("./collections/memberPhoneNumbers")),o(t("./collections/memberPreferences")),o(t("./collections/members")),o(t("./collections/opponents")),o(t("./collections/plans")),o(t("./collections/sports")),o(t("./collections/teamPreferences")),o(t("./collections/teamPublicSites")),o(t("./collections/trackedItems")),o(t("./collections/trackedItemStatuses")),o(t("./collections/users")),p},a=function(e,t){var r,n,s;n={};for(r in e)p.call(e,r)&&(s=e[r],"function"!=typeof s&&"_"!==r.charAt(0)&&(n[r]=s));for(r in t)p.call(t,r)&&(s=t[r],"function"==typeof s||e.hasOwnProperty(r)||(n[r]=s));return n}}),e.register("teamsnap",function(e,t){var r,n,s,o;s=t("./promises"),n=t("./model"),r=t("./auth"),t("./errors"),o=e,o.Collection=n.Collection,o.Item=n.Item,o.promises=s,o.apiUrl="https://apiv3.teamsnap.com",o.authUrl="https://auth.teamsnap.com",o.init=function(e,t){var n,s,i;i=r(e,t);for(s in i)n=i[s],o[s]=n;return o},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})}),e.register("types",function(e){var t,r,n,s,o,i,a,u,c,m,l;for(i=e,c=["user","assignment","availability","contact","contactEmailAddress","contactPhoneNumber","customDatum","customField","event","location","member","memberEmailAddress","memberLink","memberPhoneNumber","memberPreferences","opponent","plan","sport","team","teamPreferences","teamPublicSite","trackedItem","trackedItemStatus"],o=c.slice(1),u={},s={},r={memberPreferences:"membersPreferences",teamPreferences:"teamsPreferences",customDatum:"customData"},m=0,l=c.length;l>m;m++)a=c[m],n=a,t=r[a]||function(){switch(n.slice(-1)){case"y":return n.slice(0,-1)+"ies";case"s":return n+"es";default:return n+"s"}}(),u[n]=a,u[t]=a,s[a]=n,s[t]=n,r[a]=t,r[n]=t;i.isPluralType=function(e){return s.hasOwnProperty(e)},i.isSingularType=function(e){return r.hasOwnProperty(e)},i.hasType=function(e){return void 0!==u[e]},i.getTypes=function(){return c.slice()},i.getTeamTypes=function(){return o.slice()},i.getPluralType=function(e){return r[e]},i.getSingularType=function(e){return s[e]},i.getType=function(e){return u[e]},i.camelcaseType=function(e){return e.replace(/[-_]+(\w)/g,function(e,t){return t.toUpperCase()})},i.underscoreType=function(e){return e.replace(/[A-Z]/g,function(e){return"_"+e.toLowerCase()})}}),global.teamsnap=e("teamsnap")}();